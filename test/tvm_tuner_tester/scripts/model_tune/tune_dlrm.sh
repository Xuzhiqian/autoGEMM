#!/bin/bash
set -e
tmp=`dirname $0`
PROJECT_ROOT=`cd $tmp/../../../..; pwd`
cd ${PROJECT_ROOT}

# parameter setting
arch=a64fx
threads=1
tune_num=10
module=dlrm

# M=(128  128 128 128 128 128 128 128  128  128  512  512 512 512 512 512 512 512  512  512 )
# N=(1    13  128 256 256 512 512 512  3456 3456 1    13  128 256 256 512 512 512  3456 3456)
# K=(3456 512 256 128 512 13  256 3456 1    512  3456 512 256 128 512 13  256 3456 1    512 )

# M=(128  128 128 128 128  512  512 512 512 512 )
# N=(1    128 256 512 3456 1    128 256 512 3456)
# K=(3456 256 512 13  512  3456 256 512 13  512 )

# M=(128  128 128 128 128 128 128 128  128  128 )
# N=(1    13  128 256 256 512 512 512  3456 3456)
# K=(3456 512 256 128 512 13  256 3456 1    512 )

M=(128 128 128 128 128 128 128  128 )
N=(13  128 256 256 512 512 512  3456)
K=(512 256 128 512 13  256 3456 512 )

# M=(128  512)
# N=(512  512)
# K=(3456 3456)

# M=(128)
# N=(128)
# K=(256)

# M=(128)
# N=(256)
# K=(128)

# M=(128)
# N=(13 )
# K=(512)

# M=(128)
# N=(512)
# K=(13)

# M=(128)
# N=(256)
# K=(512)

# M=(128)
# N=(1)
# K=(3456)

# M=(128)
# N=(512)
# K=(256)

# M=(128 )
# N=(3456)
# K=(512 )

# M=(128  128)
# N=(512  3456)
# K=(3456 512)

M=(128)
N=(512)
K=(3456)

# M=(128)
# N=(1)
# K=(3456)

# calling tune.sh to opt
TUNE_SCRIPT=$PROJECT_ROOT/test/tvm_tuner_tester/scripts/utils/tune.sh
bash $TUNE_SCRIPT --arch=$arch --threads=$threads --tune_num=$tune_num --module=$module -m "${M[*]}" -n "${N[*]}" -k "${K[*]}"
